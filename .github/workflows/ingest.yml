name: Ingest new Growth Memo articles

on:
schedule:
- cron: "0 8 * * 1" # Every Monday 08:00 UTC
workflow_dispatch:
inputs:
max_articles:
description: "Max new articles to ingest"
default: "20"

jobs:
ingest:
runs-on: ubuntu-latest
timeout-minutes: 15
steps:
- uses: actions/checkout@v4
- uses: actions/setup-python@v5
with:
python-version: "3.11"
cache: "pip"
- run: pip install -r requirements.txt
- name: Run RSS ingestion
env:
SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
SUPABASE_SERVICE_KEY: ${{ secrets.SUPABASE_SERVICE_KEY }}
OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
run: python -m ingestion.ingest_rss --max ${{ github.event.inputs.max_articles || '20' }}
